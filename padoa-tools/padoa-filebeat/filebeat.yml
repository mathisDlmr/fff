filebeat:
  # List of inputs.
  inputs: []
  #   [{"type": "log", "paths": ["/tmp/*.log"]}]

  config:
    modules:
      path: "${path.config}/modules.d/*.yml"

  modules:
    - module: postgresql
      log:
        enabled: true
        var.paths: ["/tmp/*.log*"]


  registry:
    path: "/tmp/registry"

# Configure what outputs to use when sending the data collected by the beat.
# Multiple outputs may be used.
output:
  elasticsearch:
    hosts: ["logging-opensearch.back.padoa:9200"]
    index: "postgresql-%{+yyyy-MM-dd}"

setup:
  template:
    name: 'postgresql'
    pattern: 'postgresql-*'
    enabled: true
  ilm:
    enabled: false

logging:
  metrics:
    enabled: false

processors:
  - drop_fields:
      fields: ["aws", "azure", "cef", "checkpoint", "crowdstrike", "file", "gsuite", "junyper", "microsoft", "misp", "netflow", "rsa", "sophos", "suricata", "tls", "x509", "zeek", "zoom"]
      ignore_missing: true
